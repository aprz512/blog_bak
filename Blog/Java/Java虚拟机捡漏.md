---
title: Java虚拟机捡漏
index_img: /cover/25.jpg
banner_img: /cover/top.jpg
date: 2020-8-25
categories: JVM
---

之前在看《深入理解虚拟机》的时候，有点东西一直没懂，这里主要是做一些补充，避免后面自己又忘记了。

### 符号引用

符号引用（Symbolic References）：符号引用以一组符号来描述所引用的目标，符号可以是任何形式的字面量，只要使用时能够无歧义的定位到目标即可。

这个是啥意思呢？看下面：

在Java中，一个java类将会编译成一个class文件。在编译时，java类并不知道所引用的类的实际地址，因此只能使用符号引用来代替。

比如org.simple.People类引用了org.simple.Language类，在编译时People类并不知道Language类的实际内存地址，因此只能使用符号org.simple.Language（假设是这个，当然实际中是由类似于CONSTANT_Class_info的常量来表示的）来表示Language类的地址。

然后等 Class 加载到内存中之后，会将符号引用替换为具体的 Class 地址。

### 直接引用

直接引用可以是
（1）直接指向目标的指针（比如，指向“类型”【Class对象】、类变量、类方法的直接引用可能是指向方法区的指针）
（2）相对偏移量（比如，指向实例变量、实例方法的直接引用都是偏移量）
（3）一个能间接定位到目标的句柄
直接引用是和虚拟机的布局相关的，同一个符号引用在不同的虚拟机实例上翻译出来的直接引用一般不会相同。**如果有了直接引用，那引用的目标必定已经被加载入内存中了**。
