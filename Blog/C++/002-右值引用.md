---
title: 右值引用
date: 2020-9-2
categories: C++
---

不严格的来说，左值对应变量的**存储位置**，而右值对应变量的**值本身**。

```c++
int a = 10;	// a是左值，10是右值
```

左值引用很好理解，就是我们常见的引用。

```c++
int& x = a;	// ok
int& y = 10; // error, 10 是右值
```

右值引用也是引用，但是它**只能且必须**绑定在右值上。

```c++
int&& w = 42; 
int&& z = a--;   // OK: 后置自减运算符返回的是右值，将它绑定在右值引用上
int&& t = a * 1;  // OK: a * 1 的结果是一个右值，将它绑定在右值引用上
int&& v = a;       // Err: a 可以是左值，所以不能将它绑定在右值引用上
```

### 右值引用有啥用？

C++中右值可以被赋值给左值或者绑定到引用。

类的右值是一个临时对象，如果没有被绑定到引用，在**表达式结束时就会被废弃**。

于是我们可以在右值被废弃之前，移走它的资源进行废物利用，从而避免无意义的复制。被移走资源的右值在废弃时已经成为空壳，析构的开销也会降低。

**右值中的数据可以被安全移走**。

### 右值引用的使用

对于左值，如果我们明确放弃对其资源的所有权，则可以通过std::move()来将其转为右值引用。std::move()实际上是static_cast<T&&>()的简单封装。

https://www.zhihu.com/question/22111546

