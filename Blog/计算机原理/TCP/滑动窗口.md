---
title: 滑动窗口
date: 2019-08-18 11：11：11
tags: 计算机原理
---

滑动窗口是用于控制网络传输的流量的，说白了就是TCP在进行数据传输的时候，会有两个端，一个发送端，一个接收端。但是发送端与接收端它们是处于不同环境（应用、系统、硬件）的，所以它们的发送能力与接受能力肯定是不一样的，那么就很可能出现这样的问题：如果发送的速度过快，而接收端处理的较慢，就会出现接收端数据溢出的问题！！！

那么滑动窗口就是处理**这些**问题的，上面只是举了一个例子，实际上会有更多的问题，这里就不细说了，直接看看滑动窗口是如何工作的吧。



### 过程分析

1. 首先发送端发送A,B,C,D四个包，但是A,B丢失，只有C,D到达接收端。 

   ![img](https://c1.staticflickr.com/1/955/42138740462_ed4ce64c1b_b.jpg)

2. 接收端没有收到A，所以不回复ACK包。发送端重传A,B,C,D四个包，这次全都到达了。

   ![img](https://c1.staticflickr.com/1/949/42138740402_dbbbf52c8c_b.jpg)

3. 接收端先获得A，发ACK包A，但是中途丢失；根据**累计确认**的原则，发D的ACK包，然后窗口滑动。

   ![img](https://c1.staticflickr.com/1/904/27313728687_a5673da755_b.jpg)

   这里解释一下，什么是累计确认！！！

   累计确认可以理解为发送端与接收端做的一个**特殊约定**。当接收端成功收到了 A-D的所有包后，那么可以直接发一个D的确认包就OK了，然后发送端收到了D的确认包之后，就明白A-D已经全被接受了。

   根据上面的解释，我们可以推断出这样的一种情景：

   发送端发送了 A-D 包，但是 D 先到达了，那么接收端是不能发送 D 的确认包的！！！接收端只能按照顺序来发送确认包。

4. 发送端收到D的ACK包，说明4个包对方都已收到，窗口滑动，发E,F,G,H包，其中G包丢失。

   ![img](https://c1.staticflickr.com/1/951/27313728577_04e0867716_b.jpg)

5. 接收端先收到E，发ACK包；收到F后发F的ACK包；未收到G，还是**发F的ACK包**；收到H，还是**发F的ACK包**。不幸的是，三个ACK包全都丢失。 

   ![img](https://c1.staticflickr.com/1/952/27313728427_a5b7d4b107_b.jpg)

6. 发送端收到E的ACK包，窗口向右滑动一位；然后再发送F,G,H,I，其中F丢失。 

   ![img](https://c1.staticflickr.com/1/944/27313728297_65698014e9_b.jpg)

7. 接收端获得I，因为没有G，只好回复F的ACK包。之后又相继收到G,H包。 

   ![img](https://c1.staticflickr.com/1/973/28312507728_96c5813bee_b.jpg)

8. 接收端根据累计确认，发I包，其中H对应的丢失。窗口向右滑动。 

   ![img](https://c1.staticflickr.com/1/824/41284211495_31f906941b_b.jpg)

后面的就不详细说了，原来的动画在 [这个地址](http://www.exa.unicen.edu.ar/catedras/comdat1/material/Filminas3_Practico3.swf)， 下载一个 adobe player 就可以自己设置参数运行了。

